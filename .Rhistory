f<-function(x){x^3-x-1}
fe(f,1,2,e)
hujiao<-c( 0,1,2,3,4,5,6)
pinshu<-c(7,10,12,8,3,2,0)
lambda<-sum(hujiao*pinshu)/sum(pinshu)
pinshu1<-c(7,10,12,8,5)
p<-matrix(0,5,1)
for(i in 1:4){
p[i,]<-(lambda^(i-1)*exp(-lambda))/factorial(i-1)
}
p
p[5,]<-1-sum(p[1:4,])
p
sum(p[1:4,])
Newtons=function(fun,x,ep=1e-5,it_max=100){
index=0;k=1
while(k<=it_max){
x1=x;obj=fun(x);
x=x-solve(obj$J,obj$f);
norm=sqrt((x-x1)%*%(x-x1))
if(norm<ep){
index=1;break
}
k=k+1
}
obj=fun(x)
list(root=x,it=k,index=index,Funval=obj$f)
}
#求解方程的函数
funs=function(x){
f=c(x[1]^2+x[2]^2-5,(x[1]+1)*x[2]-(3*x[1]+1))
J=matrix(c(2*x[1],2*x[2],x[2]-3,x[1]+1),nrow=2,byrow=T)
list(f=f,J=J)
}
Newtons(funs,c(0,1))
fe<-function(f,a,b,eps){
if(f(a)*f(b)>0)
break
if(f(a)*f(b)<0){
repeat{
if(f(a)*f((a+b)/2)<0) b=(a+b)/2 else a=(a+b)/2
if(abs(a-b)<eps)
return((a+b)/2)
}
}
}
e<-10^(-6)
f<-function(x){x^3-x-1}
fe(f,1,2,e)
x<-c(2300,1700,2000,2500,1700,1400,1500,1200,1200,1500,1600,1700,2000,1400,1600,1200,1900,1100,1800,1300)
mean(x)
x<-c(2300,1700,2000,1500,1700,1400,1500,1200,1200,1500,1600,1700,2000,1400,1600,1200,1900,1100,1800,1300)
mean(x)
y<-x-mean(x)
y^2/19
y^2
sum(y^2)/19
((1-1/10)/20)*sum(y^2)/19
z<-c(200,150,170,150,160,130,140,100,110,140,150,160,180,130,150,100,180,100,170,120)
mean(z)
f<-mean(z)
sum(y*f)/19
y*f
f<-z-mean(z)
sum(y*f)/19
((1-1/10)/20)*(826.0256-2*0.0915*8831.579-0.0915^2*99578.95)
((1-1/10)/20)*(826.0256-2*0.0915*8831.579+0.0915^2*99578.95)
v<-((1-1/10)/20)*(826.0256-2*0.0915*8831.579+0.0915^2*99578.95)
146.3-1.96*sqrt(v)
146.3+1.96*sqrt(v)
sum(y*f)/19
(sum(y*f)/19)/(sqrt(99578.95*826.0156))
yu<-c(95,97,87,120,110,115,103,102,92,105)
xi<-c(150,155,140,180,175,185,165,160,150,170)
ym<-yu-mean(yu)
xm<-xi-mean(xi)
mean(yu)
mean(xi)
sum(y^2)/9
sum(xm^2)/9
((1-1/12)/10)*sum(xm^2)/9
((1-1/12)/10)*sum(ym^2)/9
sqrt(((1-1/12)/10)*sum(ym^2)/9)
sum(ym^2)/9
sqrt(sum(ym^2)/9)
sum(ym*m)/9
sum(ym*xm)/9
sqrt(sum(xm^2)/9)
146.333/(14.56785*10.34086)
0.971*(14.56785/10.34086)
163+1.368*(100-102.6)
((1-1/12)/10)*(212.222+1.368^2*106.933-2*1.368*146.333)
((1-1/12)/10)*212.222*(1-1.368^2)
((1-1/12)/10)*212.222*(1-1.368^2)
1.368^2
((1-1/12)/10)*212.222*(1-0.971^2)
wh<-c(8.2,6.5,13.7,5.6,11.8,11.6,17,9.8,9.8,7)
yh<-c(89,56,102,76,97,79,83,52,36,52)
y<-sum(wh*yh)
y
y<-sum(wh*yh/100)
y
wh<-c(8.2,6.5,13.7,5.6,11.8,11.6,17,9.8,8.8,7)
yh<-c(89,56,102,76,97,79,83,52,36,52)
y<-sum(wh*yh/100)
y
nh<-c(16,13,27,11,24,23,34,20,18,14)
sum(nh)
sh<-c(105,74,186,97,106,89,112,73,44,65)
vy<-sum(wh^2*sh^2/nh)
vy
vy<-sum((wh/100)^2*sh^2/nh)
vy
y
y-1.96*sqrt(vy)
y+1.96*sqrt(vy)
wh1<-c(0.2,0.3,0.5)
ph<-c(0.1,0.2,0.4)
sum(wh1*ph)
0.28*(1-0.28)/100
s<-c(0.09,0.16,0.24)
sum(wh1*s)/(0.002016)
s1<-(1/43)*(1-1/43)
s2<-(2/57)*(1-2/57)
(0.7*s1+0.3*s2)/100+(0.3*s1+0.7*s2)/10000
s3<-(0.7*s1+0.3*s2)/100+(0.3*s1+0.7*s2)/10000
sqrt(s3)
rs<-c(6.342,5.925,6.476,7.017,6.891,6.216,6.602,6.185,6.6)
rc<-c(6.387,6.188,6.457,6.947,6.875,6.439,6.243,6.227,6.6)
rs_m<-mean(rs)
rc_m<-mean(rc)
rs_m
rc_m
sum((rs-rs_m)^2)/9
sum((rs-rs_m)^2)/8
sum((rc-rc_m)^2)/8
sum((rs-rs_m)^2)/8+0.027^2
sum((rc-rc_m)^2)/8+0.015^2
x<-c(51,62,49,73,101,48,65,49,73,61,58,52,65,49,55)
z<-c(42,53,40,45,63,31,38,30,54,45,51,29,46,37,42)
y<-x/z
y
y<-z/x
y
M<-sum(x)/15
M
sum(y)/(15*M)
22/800
sum(z)/(15*M)
10/726
10/726-1
10/33-1
1- 15/87
sum(z)/(15)
(1 - 15/87)*sum((z-sum(z)/(15))^2)/(15*M^2*14)
sqrt((1 - 15/87)*sum((z-sum(z)/(15))^2)/(15*M^2*14))
0.0064*M^2/(1 - 15/87)*sum((z-sum(z)/(15))^2)
(1 - 15/87)*sum((z-sum(z)/(15))^2)/0.0064*M^2
M
((1 - 15/87)*sum((z-sum(z)/(15))^2))/(0.0064*M^2)
6.2*5.2
sqrt(44.97624)
x<c(42,51,49,55,47,58,43,59,48,41,60,52,61,49,57,63,45,46,62,58)
x<-c(42,51,49,55,47,58,43,59,48,41,60,52,61,49,57,63,45,46,62,58)
yi<-c(6.2,5.8,6.7,4.9,5.2,6.9,4.3,5.2,5.7,6.1,6.3,6.7,5.9,6.1,6,4.9,5.3,6.7,6.1,7)
m<-sum(x)/20
m
mean(yi)/m
sum(x*yi)/(20*m)
sum(x*yi)/(20)
sum(yi)/20
((1 - 20/386)*sum((x*yi-sum(x*yi)/(20))^2))/(20*19*m^2)
sqrt(((1 - 20/386)*sum((x*yi-sum(x*yi)/(20))^2))/(20*19*m^2))*1.96+5.91
5.91-sqrt(((1 - 20/386)*sum((x*yi-sum(x*yi)/(20))^2))/(20*19*m^2))*1.96
326^2-188^2/6
sqrt(326^2-188^2/6)
(188/sqrt(326^2-188^2/6))*sqrt(10)
1650/500
Mi<-c(32,45,36,54)
mi<-c(4,5,4,6)
y1<-c(4,2,3,6)
y2<-c(2,2,4,3,6)
y3<-c(3,2,5,8)
y4<-c(4,3,6,2,4,6)
Y<-c(sum(y1),sum(y2),sum(y3),sum(y4))
Y
Y_y<-sum(Y)/4
Y_y
Y_u<-sum(Y)/4
S<-c(sum((y1-mean(y1))^2)/3,sum((y2-mean(y2))^2)/4,sum((y3-mean(y3))^2)/3,sum((y4-mean(y4))^2)/5)
S
f<-c(7/8,8/9,8/9,8/9)
((100*0.6sum((Y-Y_u)^2))/12+2.5*sum((Mi^2*fS)/mi))/(500^2)
((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((Mi^2*fS)/mi))/(500^2)
((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((Mi^2*f*S)/mi))/(500^2)
MI<-Mi^2
MI*f*S)/mi
(MI*f*S)/mi
((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((MI*f*S)/mi))/(500^2)
a<-(100*0.6*sum((Y-Y_u)^2))/12
((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((MI*f*S)/mi))/(500^2))
b<-2.5*sum((MI*f*S)/mi)
c<-500^2
d<-a+b
d
d/c
e<-d/c
e^2
f<-c(8/9,8/9,8/9,8/9)
((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((MI*f*S)/mi))/(500^2)
MI
32^2
Mi<-c(32,45,36,54)
MI<-Mi^2
mi<-c(4,5,4,6)
y1<-c(4,2,3,6)
y2<-c(2,2,4,3,6)
y3<-c(3,2,5,8)
y4<-c(4,3,6,2,4,6)
Y<-c(sum(y1),sum(y2),sum(y3),sum(y4))
Y
Y_u<-sum(Y)/4
S<-c(sum((y1-mean(y1))^2)/3,sum((y2-mean(y2))^2)/4,sum((y3-mean(y3))^2)/3,sum((y4-mean(y4))^2)/5)
f<-c(7/8,8/9,8/9,8/9)
((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((MI*f*S)/mi))/(500^2)
(MI*f*S)/mi
sqrt(0.04899633)
500*sum(Y)/(sum(Mi))
sum(Y)/(sum(Mi))
(500*sum(Y)/(sum(Mi)))/(sum(Mi))
Y1<-c(mean(y1),mean(y2),mean(y3),mean(y4))
Y<-Y1*Mi
Y_u<-sum(Y)/4
S<-c(sum((y1-mean(y1))^2)/3,sum((y2-mean(y2))^2)/4,sum((y3-mean(y3))^2)/3,sum((y4-mean(y4))^2)/5)
f<-c(7/8,8/9,8/9,8/9)
((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((MI*f*S)/mi))/(500^2)
q<-((100*0.6*sum((Y-Y_u)^2))/12+2.5*sum((MI*f*S)/mi))/(500^2)
sqrt(q)
500*sum(Y)/(sum(Mi))
sum(Y)/(sum(Mi))
((100*0.6*sum(MI*((Y1-3.95)^2)))/12+2.5*sum((MI*f*S)/mi))/(500^2)
sqrt((100*0.6*sum(MI*((Y1-3.95)^2)))/12+2.5*sum((MI*f*S)/mi))/(500^2)
sqrt(((100*0.6*sum(MI*((Y1-3.95)^2)))/12+2.5*sum((MI*f*S)/mi))/(500^2))
0.404254/3.3
0.2674/3.95
x<-c(51,62,49,73,101,48,65,49,73,61,58,52,65,49,55)
z<-c(42,53,40,45,63,31,38,30,54,45,51,29,46,37,42)
y<-z/x
y
M<-sum(x)/15
M
sum(z)/(15)
sum((z-mean(z))^2)
s<-sum((z-mean(z))^2)
s1<-s/(mean(x)^2)
s2<-s1/87
0.0064*(6.2^2)+(s2-0.0064)*6.2
s1
0.0064*(7^2)+(s2-0.0064)*7
s/(0.0064*mean(z)^2)
sqrt(s/(0.0064*mean(z)^2))
s/(15*mean(x)^2)
ss<-s/(15*mean(x)^2)
sss<-ss/0.0064
(6.2^2)+(sss-1)*6.2
15*sss
(6.3^2)+(sss-1)*6.3
2
(6.2^2)+(sss-1)*6.2
ss<-s/(87*mean(x)^2)
sss<-ss/0.0064
(6.2^2)+(sss-1)*6.2
87*sss
mean(z)
mean(x)
(6.22^2)+(sss-1)*6.22
ss<-s/(15*mean(x)^2)
sss<-ss/0.0064
(6.22^2)+(sss-1)*6.22
15*sss
(6.21^2)+(sss-1)*6.21
(6.201^2)+(sss-1)*6.201
(6.2001^2)+(sss-1)*6.2001
(6.200001^2)+(sss-1)*6.200001
15*sss
(6.1800001^2)+(sss-1)*6.1800001
(6.1600001^2)+(sss-1)*6.1600001
(6.1700001^2)+(sss-1)*6.1700001
(6.1781^2)+(sss-1)*6.1781
15*sss
(6.1761^2)+(sss-1)*6.1761
zc<-c(200,160,170,100,120,180,150,100,170,130)
zz<-c(2300,1700,2000,1200,1300,2000,1600,1200,1800,1400)
mean(zc)
sum(zc)
y<-mean(zc)
sum((zc-y)^2)
sum((zc-y)^2)/9
10560/9
ss<-sum((zc-y)^2)/9
(1173.3*(1-1/15))/10
sqrt((1173.3*(1-1/15))/10)
148-10.46
148+10.46
sum(zz)
1600*148/1650
x<-mean(zz)
(sum((zc-y)*(zz-x)))/9
sum((zc-y)*(zz-x))
114000/9
sum((zz-x)^2)/9
148/1650
(1-1/15)*(1173.3-2*0.09*12666.67+(0.09^2)*142777.8)/10
(1173.3*1.96^2)/(0.01*148^2)
21/150
21/(1+21/150)
19/0.8
28/30
26/30
w<-c(0.26,0.28,0.24,0.22)
p<-c(0.9,0.867,0.933,0.9)
sum(w*p)
pp<-c(0.9,0.9333,0.9,0.8667,0.9333,0.9667)
ww<-c(0.18,0.21,0.14,0.09,0.16,0.22)
n<-c(27,28,27,26,28,29)
1-pp
pw<-1-pp
nn<-n-1
nn
sum(ww^2*pp*pw/nn)
sum(((ww^2)*pp*pw)/nn)
1-pp
ww^2
pp*pw
sum(((ww^2)*pp*pw)/nn)
sqrt(sum(((ww^2)*pp*pw)/nn))
www<-ww^2
wq<-www*pp
wq<-www*pp*pw
q<-wq/nn
q
q<-sum(wq/nn)
q
sum((w^2)*p*(1-p)/(n-1))
sum(((w^2)*p*(1-p))/(n-1))
w<-c(0.26,0.28,0.24,0.22)
p<-c(0.9,0.867,0.933,0.9)
n<-c(27,26,28,27)
sum(((w^2)*p*(1-p))/(n-1))
sqrt(0.0008965)
sqrt(sum(((w^2)*p*(1-p))/(n-1)))
x<-c(4,2,4)
y<-c(2,1,2)
x/y
sqrt(sum(((w^2)*p*(1-p))/(n-1)))
sqrt(0.0008965)
pp*(1-PP)
pp<-c(0.9,0.9333,0.9,0.8667,0.9333,0.9667)
pp*(1-PP)
pp*(1-pp)
P<-pp*(1-pp)
P<-pp*(1-pp)
s<-sum(P*ww^2)
q<-(0.1*0.924/1.96)^2
a<-sum(ww*P)/1650000
s/(a+q)
s
a
q
q<-(0.01*0.924/1.96)^2
a<-sum(ww*P)/1650000
s/(a+q)
s/a
s<-(sum(sqrt(P)*ww))^2
q<-(0.01*0.924/1.96)^2
a<-sum(ww*P)/1650000
s/(a+q)
a<-sum(ww*P)/180
s/(a+q)
1650000
1650000
a<-sum(ww*P)/1650000
s/(a+q)
1-pp
P
P
pp<-c(0.9,0.9333,0.9,0.8667,0.9333,0.9667)
ww<-c(0.18,0.21,0.14,0.09,0.16,0.22)
P<-pp*(1-pp)
s<-(sum(sqrt(P)*ww))^2
q<-(0.01*0.924/1.96)^2
a<-sum(ww*P)/1650000
s/(a+q)
pp<-c(0.9,0.9333,0.9,0.8667,0.9333,0.9667)
ww<-c(0.18,0.21,0.14,0.09,0.16,0.22)
P<-pp*(1-pp)
sh<-pp*(1-pp)
s<-(sum(sqrt(sh)*ww))^2
q<-(0.01*0.924/1.96)^2
a<-sum(ww*P)/1650000
s/(a+q)
pp<-c(0.9,0.9333,0.9,0.8667,0.9333,0.9667)
ww<-c(0.18,0.21,0.14,0.09,0.16,0.22)
sh<-pp*(1-pp)
s<-(sum(sqrt(sh)*ww))^2
q<-(0.01*0.924/1.96)^2
a<-sum(ww*sh)/1650000
s/(a+q)
2999*0.18
160/(1/5)
s<-124/(1/6)
s
s*(5/6)+160
s<-150/(1/15)
s*(1-1/6-1/5)+160+124
150*15*19/30
ss<-150*15*19/30
ss+124+160
(800+780+1709)/3
t<-c(800,780,1709)
yy<-1096.333
sum((t-yy)^2)/6
t-yy
(t-yy)^2
sum((t-yy)^2)/6
x1<-c(6,7,8,12)
x2<-c(6,8,9,12)
x3<-c(7,9,10,15)
y1<-c(6,6,7)
y2<-c(7,8,9)
y3<-c(8,9,10)
y4<-c(12,12,15)
mean(x1)
mean(x2)
mean(x3)
mean(y1)
mean(y2)
mean(y3)
mean(y4)
z<-c(6.33,8,9,13)
mean(z)
sum((x1-mean(x1))^2)/3
sum((x2-mean(x2))^2)/3
sum((x3-mean(x3))^2)/3
sum((y1-mean(y1))^2)/2
sum((y2-mean(y2))^2)/2
sum((y3-mean(y3))^2)/2
sum((y4-mean(y4))^2)/2
(sum(x1)+sum(x2)+sum(x3))/12
xx<-c(11,12,13,14,15)
6*sum((xx-13)^2)/29
(sum((x1-9.08)^2)+sum((x2-9.08)^2)+sum((x3-9.08)^2))/11
(6.92+6.25+11.58)/3
(0.33+5)/4
29/30*2.07-6*4*2.5/30
29/30*2.07
11/12*7.54-3*3*8.25/12
11/12*7.54-3*3*1.33/12
(1-1/3)*7.54/4
(1-1/4)*7.54/3
(12-3-1)/18+1/4
1/4-(12-3-1)/18
(12-3-1)/18
1/4-(4-3-1)/18
1/4+(4-3-1)/18
(6+8+9+12)/4
w<-c(0.26,0.28,0.24,0.22)
p<-c(0.9,0.867,0.933,0.9)
sum(w*p)
p*(1-p)
s<-p*(1-p)
sqrt(s)
q<-sqrt(s)
s[1]
s[2]
w[1]*q[1]/sum(w*q)
w[2]*q[2]/sum(w*q)
w[3]*q[3]/sum(w*q)
w[4]*q[4]/sum(w*q)
pp<-c(0.9,0.9333,0.9,0.8667,0.9333,0.9667)
ww<-c(0.18,0.21,0.14,0.09,0.16,0.22)
sh<-pp*(1-pp)
s<-(sum(sqrt(sh)*ww))^2
q<-(0.01/1.96)^2
a<-sum(ww*sh)/1650000
s/(a+q)
s/(a)
pp<-c(0.9,0.9333,0.9,0.8667,0.9333,0.9667)
ww<-c(0.18,0.21,0.14,0.09,0.16,0.22)
sh<-pp*(1-pp)
s<-(sum(sqrt(sh)*ww))^2
q<-(0.01/1.96)^2
a<-sum(ww*sh)/1650000
s/(a)
s/a
s/q
w<-c(0.26,0.28,0.24,0.22)
p<-c(0.9,0.867,0.933,0.9)
sum(w*p)
s<-p*(1-p)
q<-sqrt(s)
w[4]*q[4]/sum(w*q)
(sum(w*q)^2)/((0.05/1.96)^2)
138*0.26
138*0.32
138*0.2
138*0.22
536+520+417+304+396+392
148-1.96*10.46
148+1.96*10.46
setwd("F:\\交通案例库\\铁路客流量预测")
data.ST250 <- Train_Station[grep("ST250",Train_Station$on.station),]  #取出ST250站点的数据
